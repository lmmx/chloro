COMPARISON DIFF
============================================================

Original size: 4441 bytes
Chloro size:   4100 bytes
Rustfmt size:  4556 bytes

âœ— Outputs DIFFER

=== DIFF (- rustfmt, + chloro) ===
 use std::ops::{Deref, DerefMut};
 
 use either::Either;
-use hir_def::expr_store::path::Path;
-use hir_def::expr_store::ExpressionStore;
 use hir_def::GenericDefId;
+use hir_def::expr_store::ExpressionStore;
+use hir_def::expr_store::path::Path;
 use hir_def::{hir::ExprOrPatId, resolver::Resolver};
 use la_arena::{Idx, RawIdx};
 
 use crate::{
+    InferenceDiagnostic, InferenceTyDiagnosticSource, TyLoweringDiagnostic,
     db::HirDatabase,
     lower::path::{PathDiagnosticCallback, PathLoweringContext},
     lower::{LifetimeElisionKind, TyLoweringContext},
-    InferenceDiagnostic, InferenceTyDiagnosticSource, TyLoweringDiagnostic,
 };
 
-// Unfortunately, this struct needs to use interior mutability (but we encapsulate it)
-// because when lowering types and paths we hold a `TyLoweringContext` that holds a reference
-// to our resolver and so we cannot have mutable reference, but we really want to have
-// ability to dispatch diagnostics during this work otherwise the code becomes a complete mess.
 #[derive(Debug, Default, Clone)]
 pub(super) struct Diagnostics<'db>(RefCell<Vec<InferenceDiagnostic<'db>>>);
 
 impl<'db> Diagnostics<'db> {
-    pub(super) fn push(&self, diagnostic: InferenceDiagnostic<'db>) {
+    pub(super) fn push(
+        &self,
+        diagnostic: InferenceDiagnostic<'db>,
+    ) {
         self.0.borrow_mut().push(diagnostic);
     }
 
         diagnostics: Vec<TyLoweringDiagnostic>,
     ) {
         self.0.borrow_mut().extend(
-            diagnostics
-                .into_iter()
-                .map(|diag| InferenceDiagnostic::TyDiagnostic { source, diag }),
+            diagnostics.into_iter().map(|diag| InferenceDiagnostic::TyDiagnostic { source, diag }),
         );
     }
 
         node: ExprOrPatId,
     ) -> PathLoweringContext<'b, 'a, 'db> {
         let on_diagnostic = PathDiagnosticCallback {
-            data: Either::Right(PathDiagnosticCallbackData {
-                diagnostics: self.diagnostics,
-                node,
-            }),
+            data: Either::Right(PathDiagnosticCallbackData { diagnostics: self.diagnostics, node }),
             callback: |data, _, diag| {
                 let data = data.as_ref().right().unwrap();
-                data.diagnostics.push(InferenceDiagnostic::PathDiagnostic {
-                    node: data.node,
-                    diag,
-                });
+                data.diagnostics
+                    .push(InferenceDiagnostic::PathDiagnostic { node: data.node, diag });
             },
         };
         PathLoweringContext::new(&mut self.ctx, on_diagnostic, path)