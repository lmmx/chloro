COMPARISON DIFF
============================================================

Original size: 20506 bytes
Chloro size:   20360 bytes
Rustfmt size:  20506 bytes

âœ— Outputs DIFFER

=== DIFF (- rustfmt, + chloro) ===
 //! Handle syntactic aspects of inserting a new `use` item.
+
 #[cfg(test)]
 mod tests;
 
 use std::cmp::Ordering;
 
+pub use hir::PrefixKind;
 use hir::Semantics;
 use syntax::{
-    Direction, NodeOrToken, SyntaxKind, SyntaxNode, algo,
+    algo,
     ast::{
-        self, AstNode, HasAttrs, HasModuleItem, HasVisibility, PathSegmentKind,
-        edit_in_place::Removable, make,
+        self, edit_in_place::Removable, make, AstNode, HasAttrs, HasModuleItem, HasVisibility,
+        PathSegmentKind,
     },
-    ted,
+    ted, Direction, NodeOrToken, SyntaxKind, SyntaxNode,
 };
 
 use crate::{
-    RootDatabase,
     imports::merge_imports::{
-        MergeBehavior, NormalizationStyle, common_prefix, eq_attrs, eq_visibility,
-        try_merge_imports, use_tree_cmp,
+        common_prefix, eq_attrs, eq_visibility, try_merge_imports, use_tree_cmp, MergeBehavior,
+        NormalizationStyle,
     },
+    RootDatabase,
 };
 
-pub use hir::PrefixKind;
-
 /// How imports should be grouped into use statements.
 #[derive(Copy, Clone, Debug, PartialEq, Eq)]
 pub enum ImportGranularity {
                 ImportScopeKind::File(file) => ImportScopeKind::File(file.clone_for_update()),
                 ImportScopeKind::Module(item_list) => {
                     ImportScopeKind::Module(item_list.clone_for_update())
-                }
+                },
                 ImportScopeKind::Block(block) => ImportScopeKind::Block(block.clone_for_update()),
             },
             required_cfgs: self.required_cfgs.iter().map(|attr| attr.clone_for_update()).collect(),
                 "core" => ImportGroup::Std,
                 _ => ImportGroup::ExternCrate,
             },
-            // these aren't valid use paths, so fall back to something random
             PathSegmentKind::SelfTypeKw => ImportGroup::ExternCrate,
             PathSegmentKind::Type { .. } => ImportGroup::ExternCrate,
         }
                 res = ImportGranularityGuess::CrateOrModule;
             }
         }
-
         let Some((curr, curr_vis, curr_attrs)) = use_stmts.next() else { break res };
         if is_tree_one_style(&curr) {
             if res != ImportGranularityGuess::One
     };
     // there are no imports in this file at all
     // so put the import after all inner module attributes and possible license header comments
-    if let Some(last_inner_element) = scope_syntax
-        .children_with_tokens()
-        // skip the curly brace
-        .skip(l_curly.is_some() as usize)
-        .take_while(|child| match child {
-            NodeOrToken::Node(node) => is_inner_attribute(node.clone()),
-            NodeOrToken::Token(token) => {
-                [SyntaxKind::WHITESPACE, SyntaxKind::COMMENT, SyntaxKind::SHEBANG]
-                    .contains(&token.kind())
-            }
-        })
-        .filter(|child| child.as_token().is_none_or(|t| t.kind() != SyntaxKind::WHITESPACE))
-        .last()
-    {
+    if let Some(last_inner_element) = scope_syntax.children_with_tokens().skip(l_curly.is_some() as usize).take_while(|child| match child {
+        NodeOrToken::Node(node) => is_inner_attribute(node.clone()),
+        NodeOrToken::Token(token) => {
+            [SyntaxKind::WHITESPACE, SyntaxKind::COMMENT, SyntaxKind::SHEBANG].contains(
+                &token.kind(),
+            )
+        },
+    }).filter(
+        |child| child.as_token().is_none_or(|t| t.kind() != SyntaxKind::WHITESPACE),
+    ).last(
+    ) {
         cov_mark::hit!(insert_empty_inner_attr);
         ted::insert(ted::Position::after(&last_inner_element), use_item.syntax());
         ted::insert(ted::Position::after(last_inner_element), make::tokens::single_newline());
                 cov_mark::hit!(insert_empty_module);
                 ted::insert(ted::Position::after(&b), make::tokens::single_newline());
                 ted::insert(ted::Position::after(&b), use_item.syntax());
-            }
+            },
             None => {
                 cov_mark::hit!(insert_empty_file);
                 ted::insert(
                     make::tokens::blank_line(),
                 );
                 ted::insert(ted::Position::first_child_of(scope_syntax), use_item.syntax());
-            }
+            },
         }
     }
 }