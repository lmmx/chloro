COMPARISON DIFF
============================================================

Original size: 39798 bytes
Chloro size:   39560 bytes
Rustfmt size:  40546 bytes

âœ— Outputs DIFFER

=== DIFF (- rustfmt, + chloro) ===
 mod generated;
 
 use expect_test::expect;
-use hir::{db::HirDatabase, setup_tracing, Semantics};
+use hir::{Semantics, db::HirDatabase, setup_tracing};
 use ide_db::{
     assists::ExprFillDefaultMode,
     base_db::SourceDatabase,
     imports::insert_use::{ImportGranularity, InsertUseConfig},
     source_change::FileSystemEdit,
-    EditionedFileId, FileRange, RootDatabase, SnippetCap,
+    EditionedFileId,
+    FileRange,
+    RootDatabase,
+    SnippetCap,
 };
 use stdx::{format_to, trim_indent};
 use syntax::TextRange;
 use test_utils::{assert_eq_text, extract_offset};
 
 use crate::{
-    handlers::Handler, Assist, AssistConfig, AssistContext, AssistKind, AssistResolveStrategy,
-    Assists, SingleResolve,
+    handlers::Handler,
+
+    Assist, AssistConfig, AssistContext, AssistKind, AssistResolveStrategy, Assists, SingleResolve,
 };
 
 pub(crate) const TEST_CONFIG: AssistConfig = AssistConfig {
     #[rust_analyzer::rust_fixture] ra_fixture_after: &str,
 ) {
     let ra_fixture_after = trim_indent(ra_fixture_after);
-    check(
-        assist,
-        ra_fixture_before,
-        ExpectedResult::After(&ra_fixture_after),
-        None,
-    );
+    check(assist, ra_fixture_before, ExpectedResult::After(&ra_fixture_after), None);
 }
 
 #[track_caller]
     );
 }
 
-// There is no way to choose what assist within a group you want to test against,
-// so this is here to allow you choose.
 #[track_caller]
 pub(crate) fn check_assist_by_label(
     assist: Handler,
     label: &str,
 ) {
     let ra_fixture_after = trim_indent(ra_fixture_after);
-    check(
-        assist,
-        ra_fixture_before,
-        ExpectedResult::After(&ra_fixture_after),
-        Some(label),
-    );
+    check(assist, ra_fixture_before, ExpectedResult::After(&ra_fixture_after), Some(label));
 }
 
-// FIXME: instead of having a separate function here, maybe use
-// `extract_ranges` and mark the target as `<target> </target>` in the
-// fixture?
 #[track_caller]
 pub(crate) fn check_assist_target(
     assist: Handler,
     #[rust_analyzer::rust_fixture] ra_fixture: &str,
     label: &str,
 ) {
-    check(
-        assist,
-        ra_fixture,
-        ExpectedResult::NotApplicable,
-        Some(label),
-    );
+    check(assist, ra_fixture, ExpectedResult::NotApplicable, Some(label));
 }
 
 #[track_caller]
 }
 
 #[track_caller]
-fn check_doc_test(assist_id: &str, before: &str, after: &str) {
+fn check_doc_test(
+    assist_id: &str,
+    before: &str,
+    after: &str,
+) {
     let after = trim_indent(after);
     let (db, file_id, selection) = RootDatabase::with_range_or_offset(before);
     let before = db.file_text(file_id.file_id(&db)).text(&db).to_string();
-    let frange = ide_db::FileRange {
-        file_id: file_id.file_id(&db),
-        range: selection.into(),
-    };
-
+    let frange = ide_db::FileRange { file_id: file_id.file_id(&db), range: selection.into() };
     let assist = assists(&db, &TEST_CONFIG, AssistResolveStrategy::All, frange)
         .into_iter()
         .find(|assist| assist.id.0 == assist_id)
                     .join(", ")
             )
         });
-
     let actual = {
         let source_change = assist
             .source_change
 }
 
 #[track_caller]
-fn check(handler: Handler, before: &str, expected: ExpectedResult<'_>, assist_label: Option<&str>) {
+fn check(
+    handler: Handler,
+    before: &str,
+    expected: ExpectedResult<'_>,
+    assist_label: Option<&str>,
+) {
     check_with_config(TEST_CONFIG, handler, before, expected, assist_label);
 }
 
     let _tracing = setup_tracing();
     let (mut db, file_with_caret_id, range_or_offset) = RootDatabase::with_range_or_offset(before);
     db.enable_proc_attr_macros();
-    let text_without_caret = db
-        .file_text(file_with_caret_id.file_id(&db))
-        .text(&db)
-        .to_string();
-
-    let frange = hir::FileRange {
-        file_id: file_with_caret_id,
-        range: range_or_offset.into(),
-    };
-
+    let text_without_caret = db.file_text(file_with_caret_id.file_id(&db)).text(&db).to_string();
+    let frange = hir::FileRange { file_id: file_with_caret_id, range: range_or_offset.into() };
     let sema = Semantics::new(&db);
     let ctx = AssistContext::new(sema, &config, frange);
     let resolve = match expected {
         handler(&mut acc, &ctx);
     });
     let mut res = acc.finish();
-
     let assist = match assist_label {
         Some(label) => res.into_iter().find(|resolved| resolved.label == label),
         None if res.is_empty() => None,
         // Pick the first as that is the one with the highest priority
         None => Some(res.swap_remove(0)),
     };
-
     match (assist, expected) {
         (Some(assist), ExpectedResult::After(after)) => {
             let source_change = assist
 
             for file_system_edit in source_change.file_system_edits {
                 let (dst, contents) = match file_system_edit {
-                    FileSystemEdit::CreateFile {
-                        dst,
-                        initial_contents,
-                    } => (dst, initial_contents),
+                    FileSystemEdit::CreateFile { dst, initial_contents } => (dst, initial_contents),
                     FileSystemEdit::MoveFile { src, dst } => {
                         (dst, db.file_text(src).text(&db).as_ref().to_owned())
                     }
     let before = "struct Foo { $0bar: u32 }";
     let (before_cursor_pos, before) = extract_offset(before);
     let (db, file_id) = with_single_file(&before);
-    let frange = FileRange {
-        file_id: file_id.file_id(&db),
-        range: TextRange::empty(before_cursor_pos),
-    };
+    let frange =
+        FileRange { file_id: file_id.file_id(&db), range: TextRange::empty(before_cursor_pos) };
     let assists = assists(&db, &TEST_CONFIG, AssistResolveStrategy::None, frange);
     let mut assists = assists.iter();
-
-    assert_eq!(
-        assists.next().expect("expected assist").label,
-        "Change visibility to pub(crate)"
-    );
-    assert_eq!(
-        assists.next().expect("expected assist").label,
-        "Generate a getter method"
-    );
-    assert_eq!(
-        assists.next().expect("expected assist").label,
-        "Generate a mut getter method"
-    );
-    assert_eq!(
-        assists.next().expect("expected assist").label,
-        "Generate a setter method"
-    );
-    assert_eq!(
-        assists.next().expect("expected assist").label,
-        "Add `#[derive]`"
-    );
-    assert_eq!(
-        assists.next().expect("expected assist").label,
-        "Generate `new`"
-    );
+    assert_eq!(assists.next().expect("expected assist").label, "Change visibility to pub(crate)");
+    assert_eq!(assists.next().expect("expected assist").label, "Generate a getter method");
+    assert_eq!(assists.next().expect("expected assist").label, "Generate a mut getter method");
+    assert_eq!(assists.next().expect("expected assist").label, "Generate a setter method");
+    assert_eq!(assists.next().expect("expected assist").label, "Add `#[derive]`");
+    assert_eq!(assists.next().expect("expected assist").label, "Generate `new`");
     assert_eq!(assists.next().map(|it| it.label.to_string()), None);
 }
 
 }
 "#,
     );
-
     let assists = assists(
         &db,
         &TEST_CONFIG,
         AssistResolveStrategy::None,
-        FileRange {
-            file_id: frange.file_id.file_id(&db),
-            range: frange.range,
-        },
+        FileRange { file_id: frange.file_id.file_id(&db), range: frange.range },
     );
     let expected = labels(&assists);
-
     expect![[r#"
         Extract into...
         Replace if let with match
             &db,
             &cfg,
             AssistResolveStrategy::None,
-            FileRange {
-                file_id: frange.file_id.file_id(&db),
-                range: frange.range,
-            },
+            FileRange { file_id: frange.file_id.file_id(&db), range: frange.range },
         );
         let expected = labels(&assists);
 
         "#]]
         .assert_eq(&expected);
     }
-
     {
         let mut cfg = TEST_CONFIG;
         cfg.allowed = Some(vec![AssistKind::RefactorExtract]);
             &db,
             &cfg,
             AssistResolveStrategy::None,
-            FileRange {
-                file_id: frange.file_id.file_id(&db),
-                range: frange.range,
-            },
+            FileRange { file_id: frange.file_id.file_id(&db), range: frange.range },
         );
         let expected = labels(&assists);
 
         "#]]
         .assert_eq(&expected);
     }
-
     {
         let mut cfg = TEST_CONFIG;
         cfg.allowed = Some(vec![AssistKind::QuickFix]);
             &db,
             &cfg,
             AssistResolveStrategy::None,
-            FileRange {
-                file_id: frange.file_id.file_id(&db),
-                range: frange.range,
-            },
+            FileRange { file_id: frange.file_id.file_id(&db), range: frange.range },
         );
         let expected = labels(&assists);
 
 }
 "#,
     );
-
     let mut cfg = TEST_CONFIG;
     cfg.allowed = Some(vec![AssistKind::RefactorExtract]);
-
     {
         let assists = assists(
             &db,
             &cfg,
             AssistResolveStrategy::None,
-            FileRange {
-                file_id: frange.file_id.file_id(&db),
-                range: frange.range,
-            },
+            FileRange { file_id: frange.file_id.file_id(&db), range: frange.range },
         );
         assert_eq!(4, assists.len());
         let mut assists = assists.into_iter();
         "#]]
         .assert_debug_eq(&extract_into_function_assist);
     }
-
     {
         let assists = assists(
             &db,
                 assist_kind: AssistKind::RefactorExtract,
                 assist_subtype: None,
             }),
-            FileRange {
-                file_id: frange.file_id.file_id(&db),
-                range: frange.range,
-            },
+            FileRange { file_id: frange.file_id.file_id(&db), range: frange.range },
         );
         assert_eq!(4, assists.len());
         let mut assists = assists.into_iter();
         "#]]
         .assert_debug_eq(&extract_into_function_assist);
     }
-
     {
         let assists = assists(
             &db,
                 assist_kind: AssistKind::RefactorExtract,
                 assist_subtype: None,
             }),
-            FileRange {
-                file_id: frange.file_id.file_id(&db),
-                range: frange.range,
-            },
+            FileRange { file_id: frange.file_id.file_id(&db), range: frange.range },
         );
         assert_eq!(4, assists.len());
         let mut assists = assists.into_iter();
         "#]]
         .assert_debug_eq(&extract_into_function_assist);
     }
-
     {
         let assists = assists(
             &db,
             &cfg,
             AssistResolveStrategy::All,
-            FileRange {
-                file_id: frange.file_id.file_id(&db),
-                range: frange.range,
-            },
+            FileRange { file_id: frange.file_id.file_id(&db), range: frange.range },
         );
         assert_eq!(4, assists.len());
         let mut assists = assists.into_iter();