COMPARISON DIFF
============================================================

Original size: 71259 bytes
Chloro size:   70263 bytes
Rustfmt size:  71259 bytes

âœ— Outputs DIFFER

=== DIFF (- rustfmt, + chloro) ===
 use std::{iter, mem::discriminant};
 
-use crate::Analysis;
-use crate::{
-    FilePosition, NavigationTarget, RangeInfo, TryToNav, UpmappingResult,
-    doc_links::token_as_doc_comment,
-    navigation_target::{self, ToNav},
-};
 use hir::{
-    AsAssocItem, AssocItem, CallableKind, FileRange, HasCrate, InFile, ModuleDef, Semantics, sym,
+    sym, AsAssocItem, AssocItem, CallableKind, FileRange, HasCrate, InFile, ModuleDef, Semantics,
 };
-use ide_db::{MiniCore, ra_fixture::UpmapFromRaFixture};
 use ide_db::{
-    RootDatabase, SymbolKind,
     base_db::{AnchoredPath, SourceDatabase},
     defs::{Definition, IdentClass},
     famous_defs::FamousDefs,
     helpers::pick_best_token,
+    RootDatabase, SymbolKind,
 };
+use ide_db::{ra_fixture::UpmapFromRaFixture, MiniCore};
 use itertools::Itertools;
 use span::{Edition, FileId};
 use syntax::{
-    AstNode, AstToken,
-    SyntaxKind::*,
-    SyntaxNode, SyntaxToken, T, TextRange,
     ast::{self, HasLoopBody},
-    match_ast,
+    match_ast, AstNode, AstToken,
+    SyntaxKind::*,
+    SyntaxNode, SyntaxToken, TextRange, T,
+};
+
+use crate::Analysis;
+use crate::{
+    doc_links::token_as_doc_comment,
+    navigation_target::{self, ToNav},
+    FilePosition, NavigationTarget, RangeInfo, TryToNav, UpmappingResult,
 };
 
 #[derive(Debug)]
     pub minicore: MiniCore<'a>,
 }
 
-// Feature: Go to Definition
-//
-// Navigates to the definition of an identifier.
-//
-// For outline modules, this will navigate to the source file of the module.
-//
-// | Editor  | Shortcut |
-// |---------|----------|
-// | VS Code | <kbd>F12</kbd> |
-//
-// ![Go to Definition](https://user-images.githubusercontent.com/48062697/113065563-025fbe00-91b1-11eb-83e4-a5a703610b23.gif)
 pub(crate) fn goto_definition(
     db: &RootDatabase,
     FilePosition { file_id, offset }: FilePosition,
     Some(RangeInfo::new(original_token.text_range(), navs))
 }
 
-// If the token is into(), try_into(), search the definition of From, TryFrom.
 fn find_definition_for_known_blanket_dual_impls(
     sema: &Semantics<'_, RootDatabase>,
     original_token: &SyntaxToken,
     let file = token.file_id.macro_file()?;
 
     // Check that we are in the eager argument expansion of an include macro
+
     // that is we are the string input of it
     if !iter::successors(Some(file), |file| file.parent(sema.db).macro_file())
         .any(|file| file.is_include_like_macro(sema.db) && file.eager_arg(sema.db).is_none())
         None
     };
 
-    sema.descend_into_macros(token.clone())
-        .into_iter()
-        .filter_map(find_ancestors)
-        .collect_vec()
-        .into()
+    sema.descend_into_macros(token.clone()).into_iter().filter_map(find_ancestors).collect_vec().into(
+    )
 }
 
 fn nav_for_break_points(
 
 #[cfg(test)]
 mod tests {
-    use crate::{GotoDefinitionConfig, fixture};
+    use crate::{fixture, GotoDefinitionConfig};
     use ide_db::{FileRange, MiniCore};
     use itertools::Itertools;
-
-    const TEST_CONFIG: GotoDefinitionConfig<'_> =
-        GotoDefinitionConfig { minicore: MiniCore::default() };
-
+    const TEST_CONFIG: GotoDefinitionConfig<'_> = GotoDefinitionConfig { minicore: MiniCore::default() };
     #[track_caller]
     fn check(#[rust_analyzer::rust_fixture] ra_fixture: &str) {
         let (analysis, position, expected) = fixture::annotations(ra_fixture);
 
         assert_eq!(expected, navs);
     }
-
     fn check_unresolved(#[rust_analyzer::rust_fixture] ra_fixture: &str) {
         let (analysis, position) = fixture::position(ra_fixture);
         let navs = analysis
 
         assert!(navs.is_empty(), "didn't expect this to resolve anywhere: {navs:?}")
     }
-
     fn check_name(expected_name: &str, #[rust_analyzer::rust_fixture] ra_fixture: &str) {
         let (analysis, position, _) = fixture::annotations(ra_fixture);
         let navs = analysis
         };
         assert_eq!(target.name, hir::Symbol::intern(expected_name));
     }
-
     #[test]
     fn goto_def_pat_range_to_inclusive() {
         check_name(
 "#,
         );
     }
-
     #[test]
     fn goto_def_pat_range_to() {
         check_name(
 "#,
         );
     }
-
     #[test]
     fn goto_def_pat_range() {
         check_name(
 "#,
         );
     }
-
     #[test]
     fn goto_def_pat_range_inclusive() {
         check_name(
 "#,
         );
     }
-
     #[test]
     fn goto_def_pat_range_from() {
         check_name(
 "#,
         );
     }
-
     #[test]
     fn goto_def_expr_range() {
         check_name(
 "#,
         );
     }
-
     #[test]
     fn goto_def_expr_range_from() {
         check_name(
 "#,
         );
     }
-
     #[test]
     fn goto_def_expr_range_inclusive() {
         check_name(
 "#,
         );
     }
-
     #[test]
     fn goto_def_expr_range_full() {
         check_name(
 "#,
         );
     }
-
     #[test]
     fn goto_def_expr_range_to() {
         check_name(
 "#,
         );
     }
-
     #[test]
     fn goto_def_expr_range_to_inclusive() {
         check_name(
 "#,
         );
     }
-
     #[test]
     fn goto_def_in_included_file() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_in_included_file_nested() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_in_included_file_inside_mod() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_if_items_same_name() {
         check(
 "#,
         )
     }
-
     #[test]
     fn goto_def_for_extern_crate() {
         check(
 "#,
         )
     }
-
     #[test]
     fn goto_def_for_renamed_extern_crate() {
         check(
 "#,
         )
     }
-
     #[test]
     fn goto_def_in_items() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_at_start_of_item() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_definition_resolves_correct_name() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_module_declaration() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_macros() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_macros_from_other_crates() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_macros_in_use_tree() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_macro_defined_fn_with_arg() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_macro_defined_fn_no_arg() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_definition_works_for_macro_inside_pattern() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_definition_works_for_macro_inside_match_arm_lhs() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_definition_works_for_consts_inside_range_pattern() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_use_alias() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_use_alias_foo_macro() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_methods() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_fields() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_record_fields() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_record_pat_fields() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_record_fields_macros() {
         check(
 ",
         );
     }
-
     #[test]
     fn goto_for_tuple_fields() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_ufcs_inherent_methods() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_ufcs_trait_methods_through_traits() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_ufcs_trait_methods_through_self() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_definition_on_self() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_definition_on_self_in_trait_impl() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_when_used_on_definition_name_itself() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_from_macro() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_through_format() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_through_included_file() {
         check(
         "#,
         );
     }
-
     #[test]
     fn goto_through_included_file_struct_with_doc_comment() {
         check(
         "#,
         );
     }
-
     #[test]
     fn goto_for_type_param() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_within_macro() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_in_local_fn() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_in_local_macro() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_field_init_shorthand() {
         check(
 "#,
         )
     }
-
     #[test]
     fn goto_def_for_enum_variant_field() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_enum_variant_self_pattern_const() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_enum_variant_self_pattern_record() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_enum_variant_self_expr_const() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_enum_variant_self_expr_record() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_type_alias_generic_parameter() {
-        check(
-            r#"
+        check(r#"
 type Alias<T> = T$0;
          //^
-"#,
-        )
+"#)
     }
-
     #[test]
     fn goto_def_for_macro_container() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_assoc_ty_in_path() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_super_assoc_ty_in_path() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_module_declaration_in_path_if_types_and_values_same_name() {
         check(
         "#,
         )
     }
-
     #[test]
     fn unknown_assoc_ty() {
         check_unresolved(
 "#,
         )
     }
-
     #[test]
     fn goto_def_for_assoc_ty_in_path_multiple() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_assoc_ty_ufcs() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_assoc_ty_ufcs_multiple() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_self_param_ty_specified() {
         check(
 }"#,
         )
     }
-
     #[test]
     fn goto_self_param_on_decl() {
-        check(
-            r#"
+        check(r#"
 struct Foo {}
 
 impl Foo {
     fn bar(&self$0) {
           //^^^^
     }
-}"#,
-        )
+}"#)
     }
-
     #[test]
     fn goto_lifetime_param_on_decl() {
-        check(
-            r#"
+        check(r#"
 fn foo<'foobar$0>(_: &'foobar ()) {
      //^^^^^^^
-}"#,
-        )
+}"#)
     }
-
     #[test]
     fn goto_lifetime_param_decl() {
-        check(
-            r#"
+        check(r#"
 fn foo<'foobar>(_: &'foobar$0 ()) {
      //^^^^^^^
-}"#,
-        )
+}"#)
     }
-
     #[test]
     fn goto_lifetime_param_decl_nested() {
         check(
 }"#,
         )
     }
-
     #[test]
     fn goto_lifetime_hrtb() {
         // FIXME: requires the HIR to somehow track these hrtb lifetimes
 "#,
         );
     }
-
     #[test]
     fn goto_lifetime_hrtb_for_type() {
         // FIXME: requires ForTypes to be implemented
 "#,
         );
     }
-
     #[test]
     fn goto_label() {
         check(
 }"#,
         )
     }
-
     #[test]
     fn goto_def_for_intra_doc_link_same_file() {
         check(
 }"#,
         )
     }
-
     #[test]
     fn goto_def_for_intra_doc_link_outer_same_file() {
         check(
             "#,
         );
     }
-
     #[test]
     fn goto_def_for_intra_doc_link_inner_same_file() {
         check(
             "#,
         );
     }
-
     #[test]
     fn goto_def_for_intra_doc_link_inner() {
-        check(
-            r#"
+        check(r#"
 //- /main.rs
 mod m;
 struct S;
 
 //- /m.rs
 //! [`super::S$0`]
-"#,
-        )
+"#)
     }
-
     #[test]
     fn goto_incomplete_field() {
-        check(
-            r#"
+        check(r#"
 struct A { a: u32 }
          //^
 fn foo() { A { a$0: }; }
-"#,
-        )
+"#)
     }
-
     #[test]
     fn goto_proc_macro() {
         check(
             "#,
         )
     }
-
     #[test]
     fn goto_intra_doc_links() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_ident_from_pat_macro() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_include() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_include_has_eager_input() {
         check(
 "#,
         );
     }
-
-    // macros in this position are not yet supported
     #[test]
-    // FIXME
     #[should_panic]
     fn goto_doc_include_str() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_shadow_include() {
         check(
 "#,
         );
     }
-
     mod goto_impl_of_trait_fn {
         use super::check;
         #[test]
 "#,
             );
         }
-
         #[test]
         fn method_call_defaulted() {
             check(
         "#,
             );
         }
-
         #[test]
         fn method_call_on_generic() {
             check(
             );
         }
     }
-
     #[test]
     fn goto_def_of_trait_impl_const() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_of_trait_impl_type_alias() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_derive_input() {
         check(
             "#,
         );
     }
-
     #[test]
     fn goto_def_in_macro_multi() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_await_poll() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_await_into_future_poll() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_try_op() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_index_op() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_index_mut_op() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_prefix_op() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_deref_mut() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_bin_op() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_bin_op_multiple_impl() {
         check(
 "#,
         );
     }
-
     #[test]
     fn path_call_multiple_trait_impl() {
         check(
 "#,
         )
     }
-
     #[test]
     fn query_impls_in_nearest_block() {
         check(
 "#,
         );
     }
-
     #[test]
     fn implicit_format_args() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_macro_def_from_macro_use() {
         check(
             "#,
         );
     }
-
     #[test]
     fn goto_shadowed_preludes_in_block_module() {
         check(
         "#,
         );
     }
-
     #[test]
     fn goto_def_on_return_kw() {
         check(
 "#,
         )
     }
-
     #[test]
     fn goto_def_on_return_kw_in_closure() {
         check(
 "#,
         )
     }
-
     #[test]
     fn goto_def_on_break_kw() {
-        check(
-            r#"
+        check(r#"
 fn main() {
     for i in 1..5 {
  // ^^^
         break$0;
     }
 }
-"#,
-        )
+"#)
     }
-
     #[test]
     fn goto_def_on_continue_kw() {
-        check(
-            r#"
+        check(r#"
 fn main() {
     for i in 1..5 {
  // ^^^
         continue$0;
     }
 }
-"#,
-        )
+"#)
     }
-
     #[test]
     fn goto_def_on_break_kw_for_block() {
-        check(
-            r#"
+        check(r#"
 fn main() {
     'a:{
  // ^^^
         break$0 'a;
     }
 }
-"#,
-        )
+"#)
     }
-
     #[test]
     fn goto_def_on_break_with_label() {
         check(
 "#,
         );
     }
-
     #[test]
     fn label_inside_macro() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_on_return_in_try() {
         check(
 "#,
         )
     }
-
     #[test]
     fn goto_def_on_break_in_try() {
         check(
 "#,
         )
     }
-
     #[test]
     fn goto_def_on_return_in_async_block() {
-        check(
-            r#"
+        check(r#"
 fn main() {
     async {
  // ^^^^^
         return$0;
     }
 }
-"#,
-        )
+"#)
     }
-
     #[test]
     fn goto_def_on_for_kw() {
-        check(
-            r#"
+        check(r#"
 fn main() {
     for$0 i in 1..5 {}
  // ^^^
 }
-"#,
-        )
+"#)
     }
-
     #[test]
     fn goto_def_on_fn_kw() {
-        check(
-            r#"
+        check(r#"
 fn main() {
     fn$0 foo() {}
  // ^^
 }
-"#,
-        )
+"#)
     }
-
     #[test]
     fn shadow_builtin_macro() {
         check(
         "#,
         );
     }
-
     #[test]
     fn issue_18138() {
         check(
 "#,
         );
     }
-
     #[test]
     fn macro_label_hygiene() {
         check(
         "#,
         );
     }
-
     #[test]
     fn into_call_to_from_definition_within_macro() {
         check(
         "#,
         );
     }
-
     #[test]
     fn into_call_to_from_definition_with_trait_bounds() {
         check(
         "#,
         );
     }
-
     #[test]
     fn goto_into_definition_if_exists() {
         check(
         "#,
         );
     }
-
     #[test]
     fn try_into_call_to_try_from_definition() {
         check(
         "#,
         );
     }
-
     #[test]
     fn goto_try_into_definition_if_exists() {
         check(
         "#,
         );
     }
-
     #[test]
     fn parse_call_to_from_str_definition() {
         check(
         "#,
         );
     }
-
     #[test]
     fn to_string_call_to_display_definition() {
         check(
         "#,
         );
     }
-
     #[test]
     fn use_inside_body() {
         check(
     "#,
         );
     }
-
     #[test]
     fn shadow_builtin_type_by_module() {
         check(
 "#,
         );
     }
-
     #[test]
     fn not_goto_module_because_str_is_builtin_type() {
         check(
 "#,
         );
     }
-
     #[test]
     fn struct_shadow_by_module() {
         check(
 "#,
         );
     }
-
     #[test]
     fn type_alias_shadow_by_module() {
         check(
 "#,
         );
     }
-
     #[test]
     fn trait_shadow_by_module() {
         check(
             "#,
         );
     }
-
     #[test]
     fn const_shadow_by_module() {
         check(
 "#,
         );
     }
-
     #[test]
     fn offset_of() {
         check(
         "#,
         );
     }
-
     #[test]
     fn goto_def_for_match_keyword() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_match_arm_fat_arrow() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_if_keyword() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_match_nested_in_if() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_multiple_match_expressions() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_nested_match_expressions() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_if_else_chains() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_match_with_guards() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_def_for_match_with_macro_arm() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_const_from_match_pat_with_tuple_struct() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_const_from_match_pat() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_struct_from_match_pat() {
         check(
 "#,
         );
     }
-
     #[test]
     fn no_goto_trait_from_match_pat() {
         check(
 "#,
         );
     }
-
     #[test]
     fn goto_builtin_type() {
         check(
 "#,
         );
     }
-
     #[test]
     fn ra_fixture() {
         check(
         "##,
         );
     }
-
     #[test]
     fn regression_20038() {
         check(