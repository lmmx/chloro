COMPARISON DIFF
============================================================

Original size: 33665 bytes
Chloro size:   33092 bytes
Rustfmt size:  33868 bytes

âœ— Outputs DIFFER

=== DIFF (- rustfmt, + chloro) ===
 //! in this crate.
 
 // For proving that RootDatabase is RefUnwindSafe.
-
 #![cfg_attr(feature = "in-rust-tree", feature(rustc_private))]
 #![recursion_limit = "128"]
 
 #[cfg(test)]
 mod fixture;
-
 mod markup;
 mod navigation_target;
-
 mod annotations;
 mod call_hierarchy;
 mod child_modules;
 
 use cfg::CfgOptions;
 use fetch_crates::CrateInfo;
-use hir::{crate_def_map, sym, ChangeWithProcMacros, EditionedFileId};
-use ide_db::{
-    base_db::{
-        salsa::Cancelled, CrateOrigin, CrateWorkspaceData, Env, FileSet, RootQueryDb,
-        SourceDatabase, VfsPath,
-    },
-    prime_caches, symbol_index, FxHashMap, FxIndexSet, LineIndexDatabase,
-};
-use ide_db::{ra_fixture::RaFixtureAnalysis, MiniCore};
-use macros::UpmapFromRaFixture;
-use syntax::{ast, SourceFile};
-use triomphe::Arc;
-use view_memory_layout::{view_memory_layout, RecursiveMemoryLayout};
-
-use crate::navigation_target::ToNav;
-
-pub use crate::{
-    annotations::{Annotation, AnnotationConfig, AnnotationKind, AnnotationLocation},
-    call_hierarchy::{CallHierarchyConfig, CallItem},
-    expand_macro::ExpandedMacro,
-    file_structure::{FileStructureConfig, StructureNode, StructureNodeKind},
-    folding_ranges::{Fold, FoldKind},
-    goto_definition::GotoDefinitionConfig,
-    goto_implementation::GotoImplementationConfig,
-    highlight_related::{HighlightRelatedConfig, HighlightedRange},
-    hover::{
-        HoverAction, HoverConfig, HoverDocFormat, HoverGotoTypeData, HoverResult,
-        MemoryLayoutHoverConfig, MemoryLayoutHoverRenderKind, SubstTyLen,
-    },
-    inlay_hints::{
-        AdjustmentHints, AdjustmentHintsMode, ClosureReturnTypeHints, DiscriminantHints,
-        GenericParameterHints, InlayFieldsToResolve, InlayHint, InlayHintLabel, InlayHintLabelPart,
-        InlayHintPosition, InlayHintsConfig, InlayKind, InlayTooltip, LazyProperty,
-        LifetimeElisionHints,
-    },
-    join_lines::JoinLinesConfig,
-    markup::Markup,
-    moniker::{
-        Moniker, MonikerDescriptorKind, MonikerIdentifier, MonikerKind, MonikerResult,
-        PackageInformation, SymbolInformationKind,
-    },
-    move_item::Direction,
-    navigation_target::{NavigationTarget, TryToNav, UpmappingResult},
-    references::{FindAllRefsConfig, ReferenceSearchResult},
-    rename::{RenameConfig, RenameError},
-    runnables::{Runnable, RunnableKind, TestId, UpdateTest},
-    signature_help::SignatureHelp,
-    static_index::{
-        StaticIndex, StaticIndexedFile, TokenId, TokenStaticData, VendoredLibrariesConfig,
-    },
-    syntax_highlighting::{
-        tags::{Highlight, HlMod, HlMods, HlOperator, HlPunct, HlTag},
-        HighlightConfig, HlRange,
-    },
-    test_explorer::{TestItem, TestItemKind},
-};
 pub use hir::Semantics;
+use hir::{crate_def_map, sym, ChangeWithProcMacros, EditionedFileId};
 pub use ide_assists::{
     Assist, AssistConfig, AssistId, AssistKind, AssistResolveStrategy, SingleResolve,
 };
     text_edit::{Indel, TextEdit},
     FileId, FilePosition, FileRange, RootDatabase, Severity, SymbolKind,
 };
+use ide_db::{
+    base_db::{
+        salsa::Cancelled, CrateOrigin, CrateWorkspaceData, Env, FileSet, RootQueryDb,
+        SourceDatabase, VfsPath,
+    },
+    prime_caches, symbol_index, FxHashMap, FxIndexSet, LineIndexDatabase,
+};
+use ide_db::{ra_fixture::RaFixtureAnalysis, MiniCore};
 pub use ide_diagnostics::{Diagnostic, DiagnosticCode, DiagnosticsConfig};
 pub use ide_ssr::SsrError;
+use macros::UpmapFromRaFixture;
 pub use span::Edition;
+use syntax::{ast, SourceFile};
 pub use syntax::{TextRange, TextSize};
+use triomphe::Arc;
+use view_memory_layout::{view_memory_layout, RecursiveMemoryLayout};
+
+use crate::navigation_target::ToNav;
+pub use crate::{
+    annotations::{Annotation, AnnotationConfig, AnnotationKind, AnnotationLocation},
+    call_hierarchy::{CallHierarchyConfig, CallItem},
+    expand_macro::ExpandedMacro,
+    file_structure::{FileStructureConfig, StructureNode, StructureNodeKind},
+    folding_ranges::{Fold, FoldKind},
+    goto_definition::GotoDefinitionConfig,
+    goto_implementation::GotoImplementationConfig,
+    highlight_related::{HighlightRelatedConfig, HighlightedRange},
+    hover::{
+        HoverAction, HoverConfig, HoverDocFormat, HoverGotoTypeData, HoverResult,
+        MemoryLayoutHoverConfig, MemoryLayoutHoverRenderKind, SubstTyLen,
+    },
+    inlay_hints::{
+        AdjustmentHints, AdjustmentHintsMode, ClosureReturnTypeHints, DiscriminantHints,
+        GenericParameterHints, InlayFieldsToResolve, InlayHint, InlayHintLabel,
+        InlayHintLabelPart, InlayHintPosition, InlayHintsConfig, InlayKind, InlayTooltip,
+        LazyProperty, LifetimeElisionHints,
+    },
+    join_lines::JoinLinesConfig,
+    markup::Markup,
+    moniker::{
+        Moniker, MonikerDescriptorKind, MonikerIdentifier, MonikerKind, MonikerResult,
+        PackageInformation, SymbolInformationKind,
+    },
+    move_item::Direction,
+    navigation_target::{NavigationTarget, TryToNav, UpmappingResult},
+    references::{FindAllRefsConfig, ReferenceSearchResult},
+    rename::{RenameConfig, RenameError},
+    runnables::{Runnable, RunnableKind, TestId, UpdateTest},
+    signature_help::SignatureHelp,
+    static_index::{
+        StaticIndex, StaticIndexedFile, TokenId, TokenStaticData, VendoredLibrariesConfig,
+    },
+    syntax_highlighting::{
+        tags::{Highlight, HlMod, HlMods, HlOperator, HlPunct, HlTag}, HighlightConfig, HlRange,
+    },
+    test_explorer::{TestItem, TestItemKind},
+};
 
 pub type Cancellable<T> = Result<T, Cancelled>;
 
 
 impl AnalysisHost {
     pub fn new(lru_capacity: Option<u16>) -> AnalysisHost {
-        AnalysisHost {
-            db: RootDatabase::new(lru_capacity),
-        }
+        AnalysisHost { db: RootDatabase::new(lru_capacity) }
     }
 
     pub fn with_database(db: RootDatabase) -> AnalysisHost {
     /// Returns a snapshot of the current state, which you can query for
     /// semantic information.
     pub fn analysis(&self) -> Analysis {
-        Analysis {
-            db: self.db.clone(),
-        }
+        Analysis { db: self.db.clone() }
     }
 
     /// Applies changes to the current state of the world. If there are
     pub fn per_query_memory_usage(&mut self) -> Vec<(String, profile::Bytes, usize)> {
         self.db.per_query_memory_usage()
     }
+
     pub fn request_cancellation(&mut self) {
         self.db.request_cancellation();
     }
+
     pub fn raw_database(&self) -> &RootDatabase {
         &self.db
     }
+
     pub fn raw_database_mut(&mut self) -> &mut RootDatabase {
         &mut self.db
     }
     db: RootDatabase,
 }
 
-// As a general design guideline, `Analysis` API are intended to be independent
-// from the language server protocol. That is, when exposing some functionality
-// we should think in terms of "what API makes most sense" and not in terms of
-// "what types LSP uses". Although currently LSP is the only consumer of the
-// API, the API should in theory be usable as a library, or via a different
-// protocol.
 impl Analysis {
-    // Creates an analysis instance for a single file, without any external
-    // dependencies, stdlib support or ability to apply changes. See
-    // `AnalysisHost` for creating a fully-featured analysis.
     pub fn from_single_file(text: String) -> (Analysis, FileId) {
         let mut host = AnalysisHost::default();
         let file_id = FileId::from_raw(0);
             cfg_options,
             None,
             Env::default(),
-            CrateOrigin::Local {
-                repo: None,
-                name: None,
-            },
+            CrateOrigin::Local { repo: None, name: None },
             false,
             proc_macro_cwd,
             Arc::new(CrateWorkspaceData {
     ) -> Option<(Analysis, RaFixtureAnalysis)> {
         let analysis =
             RaFixtureAnalysis::analyze_ra_fixture(sema, literal, expanded, minicore, on_cursor)?;
-        Some((
-            Analysis {
-                db: analysis.db.clone(),
-            },
-            analysis,
-        ))
+        Some((Analysis { db: analysis.db.clone() }, analysis))
     }
 
     /// Debug info about the current state of the analysis.
         self.with_db(test_explorer::discover_test_roots)
     }
 
-    pub fn discover_tests_in_crate_by_test_id(&self, crate_id: &str) -> Cancellable<Vec<TestItem>> {
+    pub fn discover_tests_in_crate_by_test_id(
+        &self,
+        crate_id: &str,
+    ) -> Cancellable<Vec<TestItem>> {
         self.with_db(|db| test_explorer::discover_tests_in_crate_by_test_id(db, crate_id))
     }
 
 
     /// Returns an edit to remove all newlines in the range, cleaning up minor
     /// stuff like trailing commas.
-    pub fn join_lines(&self, config: &JoinLinesConfig, frange: FileRange) -> Cancellable<TextEdit> {
+    pub fn join_lines(
+        &self,
+        config: &JoinLinesConfig,
+        frange: FileRange,
+    ) -> Cancellable<TextEdit> {
         self.with_db(|db| {
             let editioned_file_id_wrapper =
                 EditionedFileId::current_edition(&self.db, frange.file_id);
     ) -> Cancellable<Vec<InlayHint>> {
         self.with_db(|db| inlay_hints::inlay_hints(db, file_id, range, config))
     }
+
     pub fn inlay_hints_resolve(
         &self,
         config: &InlayHintsConfig<'_>,
         position: FilePosition,
         imports: impl IntoIterator<Item = String> + std::panic::UnwindSafe,
     ) -> Cancellable<Vec<TextEdit>> {
-        Ok(self
-            .with_db(|db| ide_completion::resolve_completion_edits(db, config, position, imports))?
-            .unwrap_or_default())
+        Ok(
+            self.with_db(|db| ide_completion::resolve_completion_edits(db, config, position, imports))?.unwrap_or_default(),
+        )
     }
 
     /// Computes the set of parser level diagnostics for the given file.
             let mut match_finder =
                 ide_ssr::MatchFinder::in_context(db, resolve_context, selections)?;
             match_finder.add_rule(rule)?;
-            let edits = if parse_only {
-                Default::default()
-            } else {
-                match_finder.edits()
-            };
+            let edits = if parse_only { Default::default() } else { match_finder.edits() };
             Ok(SourceChange::from_iter(edits))
         })
     }