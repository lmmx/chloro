COMPARISON DIFF
============================================================

Original size: 22455 bytes
Chloro size:   22479 bytes
Rustfmt size:  22455 bytes

âœ— Outputs DIFFER

=== DIFF (- rustfmt, + chloro) ===
 use vfs::{AbsPathBuf, ChangeKind, VfsPath};
 
 use crate::{
-    config::{Config, ConfigChange},
-    flycheck::{InvocationStrategy, Target},
-    global_state::{FetchWorkspaceRequest, GlobalState},
-    lsp::{from_proto, utils::apply_document_changes},
-    lsp_ext::{self, RunFlycheckParams},
-    mem_docs::DocumentData,
-    reload,
-    target_spec::TargetSpec,
-    try_default,
+    config::{Config, flycheck::{InvocationStrategy, global_state::{FetchWorkspaceRequest,
+    lsp::{from_proto, lsp_ext::{self, mem_docs::DocumentData, reload, target_spec::TargetSpec,
+    try_default, utils::apply_document_changes}, ConfigChange}, GlobalState}, RunFlycheckParams},
+    Target},
 };
 
-pub(crate) fn handle_cancel(state: &mut GlobalState, params: CancelParams) -> anyhow::Result<()> {
+pub(crate) fn handle_cancel(
+    state: &mut GlobalState,
+    params: CancelParams,
+) -> anyhow::Result<()> {
     let id: lsp_server::RequestId = match params.id {
         lsp_types::NumberOrString::Number(id) => id.into(),
         lsp_types::NumberOrString::String(id) => id.into(),
     {
         flycheck.cancel();
     }
-
     // Just ignore this. It is OK to continue sending progress
     // notifications for this token, as the client can't know when
     // we accepted notification.
     params: DidOpenTextDocumentParams,
 ) -> anyhow::Result<()> {
     let _p = tracing::info_span!("handle_did_open_text_document").entered();
-
     if let Ok(path) = from_proto::vfs_path(&params.text_document.uri) {
         let already_exists = state
             .mem_docs
     params: DidChangeTextDocumentParams,
 ) -> anyhow::Result<()> {
     let _p = tracing::info_span!("handle_did_change_text_document").entered();
-
     if let Ok(path) = from_proto::vfs_path(&params.text_document.uri) {
         let Some(DocumentData { version, data }) = state.mem_docs.get_mut(&path) else {
             tracing::error!(?path, "unexpected DidChangeTextDocument");
     params: DidCloseTextDocumentParams,
 ) -> anyhow::Result<()> {
     let _p = tracing::info_span!("handle_did_close_text_document").entered();
-
     if let Ok(path) = from_proto::vfs_path(&params.text_document.uri) {
         if state.mem_docs.remove(&path).is_err() {
             tracing::error!("orphan DidCloseTextDocument: {}", path);
             flycheck.restart_workspace(None);
         }
     }
-
     Ok(())
 }
 
             }
         },
     );
-
     Ok(())
 }
 
     params: DidChangeWorkspaceFoldersParams,
 ) -> anyhow::Result<()> {
     let config = Arc::make_mut(&mut state.config);
-
     for workspace in params.event.removed {
         let Ok(path) = workspace.uri.to_file_path() else { continue };
         let Ok(path) = Utf8PathBuf::from_path_buf(path) else { continue };
         let Ok(path) = AbsPathBuf::try_from(path) else { continue };
         config.remove_workspace(&path);
     }
-
     let added = params
         .event
         .added
         .filter_map(|it| Utf8PathBuf::from_path_buf(it).ok())
         .filter_map(|it| AbsPathBuf::try_from(it).ok());
     config.add_workspaces(added);
-
     if !config.has_linked_projects() && config.detached_files().is_empty() {
         config.rediscover_workspaces();
 
         let req = FetchWorkspaceRequest { path: None, force_crate_graph_reload: false };
         state.fetch_workspaces_queue.request_op("client workspaces changed".to_owned(), req);
     }
-
     Ok(())
 }
 
     Ok(())
 }
 
-fn run_flycheck(state: &mut GlobalState, vfs_path: VfsPath) -> bool {
+fn run_flycheck(
+    state: &mut GlobalState,
+    vfs_path: VfsPath,
+) -> bool {
     let _p = tracing::info_span!("run_flycheck").entered();
-
     let file_id = state.vfs.read().0.file_id(&vfs_path);
     if let Some((file_id, vfs::FileExcluded::No)) = file_id {
         let world = state.snapshot();
     }
 }
 
-pub(crate) fn handle_cancel_flycheck(state: &mut GlobalState, _: ()) -> anyhow::Result<()> {
+pub(crate) fn handle_cancel_flycheck(
+    state: &mut GlobalState,
+    _: (),
+) -> anyhow::Result<()> {
     let _p = tracing::info_span!("handle_cancel_flycheck").entered();
     state.flycheck.iter().for_each(|flycheck| flycheck.cancel());
     Ok(())
 }
 
-pub(crate) fn handle_clear_flycheck(state: &mut GlobalState, _: ()) -> anyhow::Result<()> {
+pub(crate) fn handle_clear_flycheck(
+    state: &mut GlobalState,
+    _: (),
+) -> anyhow::Result<()> {
     let _p = tracing::info_span!("handle_clear_flycheck").entered();
     state.diagnostics.clear_check_all();
     Ok(())
     Ok(())
 }
 
-pub(crate) fn handle_abort_run_test(state: &mut GlobalState, _: ()) -> anyhow::Result<()> {
+pub(crate) fn handle_abort_run_test(
+    state: &mut GlobalState,
+    _: (),
+) -> anyhow::Result<()> {
     if state.test_run_session.take().is_some() {
         state.send_notification::<lsp_ext::EndRunTest>(());
     }